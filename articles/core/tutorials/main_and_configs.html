<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Setting up an Entry Point | MARS LIFE Runtime System </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Setting up an Entry Point | MARS LIFE Runtime System ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../../../images/mars/mars-icon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
  
  <meta property="docfx:rel" content="../../../">
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../images/mars/mars-icon-resized.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>

                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../../articles/about_mars.html" title="Documentation">Documentation</a>
                      </li>
                      <li>
                          <a href="../../../simulation/Mars.Core.html" title="Core API">Core API</a>
                      </li>
                      <li>
                          <a href="../../../soh/SOHBicycleModel.Common.html" title="SmartOpenHamburg API">SmartOpenHamburg API</a>
                      </li>
                      <li>
                          <a href="../../../components/Mars.Components.html" title="Model Components API">Model Components API</a>
                      </li>
                      <li>
                          <a href="../../../common/Mars.Common.html" title="Common API">Common API</a>
                      </li>
                </ul>            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">

                  <ul class="nav level1">
                    <li class="">
                      <a href="../../dsl/index.html" title="MARS DSL Language" class="">MARS DSL Language</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../../core/index.html" title="MARS Runtime System" class="">MARS Runtime System</a>

                        <ul class="nav level2">
                          <li class="">
                            <a href="../../core/getting-started/index.html" title="Getting started with MARS" class="">Getting started with MARS</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../core/basic-concepts/index.html" title="Basic Concepts" class="">Basic Concepts</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../core/basic-concepts/multi-agent-simulation.html" title="Multi-Agent-Simulation" class="">Multi-Agent-Simulation</a>
                                </li>
                                <li class="">
                                  <a href="../../core/basic-concepts/agent.html" title="Agents" class="">Agents</a>
                                </li>
                                <li class="">
                                  <a href="../../core/basic-concepts/layers.html" title="Layers" class="">Layers</a>
                                </li>
                                <li class="">
                                  <a href="../../core/basic-concepts/entity.html" title="Entities" class="">Entities</a>
                                </li>
                                <li class="">
                                  <span class="expand-stub"></span>
                                  <a href="../../core/basic-concepts/environments/index.html" title="Environments" class="">Environments</a>

                                    <ul class="nav level4">
                                      <li class="">
                                        <a href="../../core/basic-concepts/environments/spatialhashenv.html" title="SpatialHashEnvironment" class="">SpatialHashEnvironment</a>
                                      </li>
                                      <li class="">
                                        <a href="../../core/basic-concepts/environments/geohashenv.html" title="GeoHashEnvironment" class="">GeoHashEnvironment</a>
                                      </li>
                                      <li class="">
                                        <a href="../../core/basic-concepts/environments/spatialgraphenv.html" title="SpatialGraphEnvironment" class="">SpatialGraphEnvironment</a>
                                      </li>
                                      <li class="">
                                        <a href="../../core/basic-concepts/environments/collisionenv.html" title="CollisionEnvironment" class="">CollisionEnvironment</a>
                                      </li>
                                    </ul>                                </li>
                                <li class="">
                                  <a href="../../core/basic-concepts/model.html" title="Model Setup" class="">Model Setup</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../core/model-configuration/index.html" title="Model Configuration" class="">Model Configuration</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../core/model-configuration/agent_config.html" title="Agent and Entity Configuration" class="">Agent and Entity Configuration</a>
                                </li>
                                <li class="">
                                  <a href="../../core/model-configuration/layer_config.html" title="Layer Configuration" class="">Layer Configuration</a>
                                </li>
                                <li class="">
                                  <a href="../../core/model-configuration/output_filter.html" title="Output Filter" class="">Output Filter</a>
                                </li>
                                <li class="">
                                  <a href="../../core/model-configuration/sim_config_options.html" title="Simulation Configuration Options" class="">Simulation Configuration Options</a>
                                </li>
                                <li class="">
                                  <a href="../../core/model-configuration/sim_output_formats.html" title="Simulation Output Formats" class="">Simulation Output Formats</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../core/data-sources/index.html" title="Data Sources" class="">Data Sources</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../core/data-sources/geospatial_data_sources.html" title="Geospatial Data Sources" class="">Geospatial Data Sources</a>
                                </li>
                                <li class="">
                                  <a href="../../core/data-sources/geospatial_data_types.html" title="Geospatial Data Types" class="">Geospatial Data Types</a>
                                </li>
                                <li class="">
                                  <a href="../../core/data-sources/ascii-grid.html" title="ASCII grid (.asc)" class="">ASCII grid (.asc)</a>
                                </li>
                                <li class="">
                                  <a href="../../core/data-sources/csv.html" title="CSV" class="">CSV</a>
                                </li>
                                <li class="">
                                  <a href="../../core/data-sources/time-series.html" title="Time-series Data" class="">Time-series Data</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../core/analysis-and-visualization/index.html" title="Analysis and Visualization" class="">Analysis and Visualization</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../core/analysis-and-visualization/visualizing_agent_trips_kepler.html" title="Visualizing Agent Movement Trajectories" class="">Visualizing Agent Movement Trajectories</a>
                                </li>
                                <li class="">
                                  <a href="../../core/analysis-and-visualization/live_visualization.html" title="Simple Live Visualization" class="">Simple Live Visualization</a>
                                </li>
                                <li class="">
                                  <a href="../../core/analysis-and-visualization/visualizing_sim_results.html" title="Analyzing Output Data" class="">Analyzing Output Data</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../core/tutorials/index.html" title="Tutorials" class="">Tutorials</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../core/tutorials/create_new_mars_csharp_project.html" title="Creating a new MARS C# project" class="">Creating a new MARS C# project</a>
                                </li>
                                <li class="active">
                                  <a href="../../core/tutorials/main_and_configs.html" title="Creating a starting point for your model" class="active">Creating a starting point for your model</a>
                                </li>
                                <li class="">
                                  <a href="../../core/tutorials/create_vector_layer_raster_layer.html" title="Creating vector and raster layer files" class="">Creating vector and raster layer files</a>
                                </li>
                                <li class="">
                                  <a href="../../core/tutorials/wolf_sheep_tutorial.html" title="Building your first model (wolf-sheep-grass)" class="">Building your first model (wolf-sheep-grass)</a>
                                </li>
                                <li class="">
                                  <a href="../../core/help/index.html" title="Common problems and solutions" class="">Common problems and solutions</a>
                                </li>
                                <li class="">
                                  <a href="../../core/tutorials/geo-data-acquisition.html" title="Acquire geo data for layers" class="">Acquire geo data for layers</a>
                                </li>
                                <li class="">
                                  <a href="../../core/tutorials/deploy_in_cloud.html" title="Build and start your model in Kubernetes cluster" class="">Build and start your model in Kubernetes cluster</a>
                                </li>
                              </ul>                          </li>
                        </ul>                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="../../soh/index.html" title="SmartOpenHamburg" class="">SmartOpenHamburg</a>

                        <ul class="nav level2">
                          <li class="">
                            <a href="../../soh/getting-started.html" title="Quick Start" class="">Quick Start</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../soh/scenarios/index.html" title="Ready to use scenarios (boxes)" class="">Ready to use scenarios (boxes)</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../soh/scenarios/ferry_transfer.html" title="Ferry Transfer" class="">Ferry Transfer</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/scenarios/green_4_bikes.html" title="Green4Bikes" class="">Green4Bikes</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/scenarios/ferry_transfer_green4bikes_results.html" title="Results" class="">Results</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/scenarios/ferry_transfer_green4bikes_result_scheme.html" title="Result Schemas" class="">Result Schemas</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../soh/index.html" title="Layer" class="">Layer</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../soh/layers/multi_modal_layer.html" title="Multimodal Layer" class="">Multimodal Layer</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/layers/modal_layer.html" title="Modal Layer" class="">Modal Layer</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/layers/scheduling_layer.html" title="Scheduling Layer" class="">Scheduling Layer</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/layers/vector_layer.html" title="Vector Layer" class="">Vector Layer</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../soh/index.html" title="Agents" class="">Agents</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../soh/agents.html" title="Behaviour Model" class="">Behaviour Model</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/agents/multi_modal_agent.html" title="Multimodal" class="">Multimodal</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/agents/multi_capable_agent.html" title="Multi-Capable" class="">Multi-Capable</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/steering.html" title="Multi-Modality" class="">Multi-Modality</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/agents/citizen.html" title="Citizen" class="">Citizen</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/agents/traveler.html" title="Traveler" class="">Traveler</a>
                                </li>
                              </ul>                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="../../soh/index.html" title="Entities" class="">Entities</a>

                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../soh/entities.html" title="Referencing" class="">Referencing</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/entities/car.html" title="Street Vehicles" class="">Street Vehicles</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/entities/bicycle.html" title="Bicycle Vehicles" class="">Bicycle Vehicles</a>
                                </li>
                                <li class="">
                                  <a href="../../soh/entities/ferry.html" title="Ferry" class="">Ferry</a>
                                </li>
                              </ul>                          </li>
                        </ul>                    </li>
                  </ul>                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="setting-up-an-entry-point">Setting up an Entry Point</h2>

<p>Starting a simulation required an entry point of execution. In default cases of programming this is the so called <code>Main</code> (in Java <code>main</code>; in Python <code>__main__</code>). This method have to be provided by the model itself. </p>
<p>Create a file called <code>Program.cs</code>. Define a class called <code>Program</code> containing <strong>static</strong> method <code>Main(string[] arguments)</code>. </p>
<blockquote><p>This is the default for each .Net program you write, nothing special for MARS</p>
</blockquote>
<pre><code class="lang-c#">public class Program {



}    
</code></pre><p>Thats it, now you can start your .Net program &#10024; </p>
<h2 id="describe-your-model">Describe your model</h2>
<p>At the beginning of the <code>Main</code>, a ModelDescription (let&#39;s call it <code>description</code>) is defined. It contains all layer types and agent types that are part of the model.</p>
<pre><code class="lang-c#">public static void Main(string[] args)
{
    var description = new ModelDescription();

    description.AddLayer&lt;Layer1&gt;();
    description.AddLayer&lt;Layer2&gt;();
    description.AddAgent&lt;Agent1, Layer1&gt;();
</code></pre><h2 id="create-the-simulation-configuration-in-code">Create the simulation configuration in code</h2>
<p>In order to define a simulation configuration that exists within the <code>Main</code>, a SimulationConfig (let&#39;s call it <code>config</code>) object can be created. The code that defines the configuration can be written in a method outside of the <code>Main</code>, as seen in the following example:</p>
<pre><code class="lang-c#">    var config = CreateDefaultConfig();
</code></pre><pre><code class="lang-c#">private static SimulationConfig CreateDefaultConfig()
{
    var startPoint = DateTime.Parse(&quot;2020-01-01T00:00:00&quot;);
    var config = new SimulationConfig
    {
        SimulationIdentifier = &quot;green4bikes&quot;,
        Globals =
        {
            StartPoint = startPoint,
            EndPoint = startPoint + TimeSpan.FromHours(24),
            DeltaTUnit = TimeSpanUnit.Seconds,
            ShowConsoleProgress = true,
            OutputTarget = OutputTargetType.Csv,
            // simulation output formats
        },
        // layer configuration
        // agent configuration
    };
    return config;
}
</code></pre><table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>StartPoint</code></td>
<td>the start time of the simulation</td>
<td>01.01.2020</td>
</tr>
<tr>
<td><code>EndPoint</code></td>
<td>the end time of the simulation</td>
<td>31.01.2020</td>
</tr>
<tr>
<td><code>DeltaTUnit</code></td>
<td>the unit of a single time step</td>
<td><code>TimeSpanUnit.Seconds</code></td>
</tr>
<tr>
<td><code>ShowConsoleProgress</code></td>
<td>if <code>true</code>, the simulation progress is displayed in the terminal</td>
<td><code>true</code> or <code>false</code></td>
</tr>
<tr>
<td><code>OutputTarget</code></td>
<td>the medium into which simulation output data is stored (set to csv in the above example)</td>
<td><code>csv</code></td>
</tr>
</tbody>
</table>
<p>For more information on simulation output formats, please click <a href="../model-configuration/sim_output_formats.html">here</a>.</p>
<p>For more information on layer configuration, please click <a href="../model-configuration/layer_config.html">here</a>.</p>
<p>For more information on agent configuration, please click <a href="../model-configuration/agent_config.html">here</a>.</p>
<hr>
<h2 id="use-external-simulation-configurations-json">Use external simulation configurations (JSON)</h2>
<p>In order to define a simulation configuration that exist outside of the model, a JSON file can be created as seen in the following example:</p>
<ol>
<li><p><code>Globals</code>: in this section, the simulation&#39;s global parameters are set. Here is an example:</p>
<pre><code>{
  &quot;globals&quot;: {
    &quot;startPoint&quot;: &quot;2020-01-01T00:00:00&quot;,
    &quot;endPoint&quot;: &quot;2020-01-01T01:00:00&quot;,
    &quot;deltaT&quot;: 1,
    &quot;deltaTUnit&quot;: &quot;seconds&quot;,
 &quot;console&quot;: true,
    &quot;output&quot;: &quot;csv&quot;,
    // simulation output formats
  },
</code></pre></li>
</ol>
<ul>
<li><code>startPoint</code>: the start time of the simulation</li>
<li><code>endPoint</code>: the end time of the simulation</li>
<li><code>deltaT</code>: the length of a single time step</li>
<li><code>deltaTUnit</code>: the unit of a single time step</li>
<li><code>console</code>: if <code>true</code>, the simulation progress is displayed in the terminal</li>
<li><code>output</code>: the medium into which simulation output data is stored</li>
</ul>
<p>For more information on simulation output formats, please click <a href="../model-configuration/sim_output_formats.html">here</a>.</p>
<p>For more information on layer configuration, please click <a href="../model-configuration/layer_config.html">here</a>.</p>
<p>For more information on agent configuration, please click <a href="../model-configuration/agent_config.html">here</a>.</p>
<hr>
<h2 id="build-the-application-and-run-the-simulation">Build the application and run the simulation</h2>
<p>Now that a ModelDescription and a configuration (a SimulationConfig (Part2a) or an external JSON file (Part2b)) of the model exists, an <code>ISimulationContainer</code> object (let&#39;s call it <code>application</code>) can be created. <code>application</code> receives <code>description</code> and the simulation configuration of your choice in order to execute the simulation.</p>
<p>In the following example, the simulation configuration is chosen during an if-else-statement. The <code>Main</code> checks if an argument (a path to an external simulation configuration) was passed at the time of execution. If yes, then the program attempts to use the external information to configure the model (see if-branch). If no, then the internal model configuration (Part 2a) is used (see else-branch).</p>
<p>The simulation is started by resolving the application and calling <code>StartSimulation()</code>.</p>
<pre><code class="lang-c#">    ISimulationContainer application;

    if (args != null &amp;&amp; args.Any())
    {
        var file = File.ReadAllText(Path.Combine(ResourcesConstants.SimConfigFolder, args[0]));
        var simConfig = SimulationConfig.Deserialize(file);
        Console.WriteLine($&quot;Use simulation config: {args[0]}&quot;);
        Console.WriteLine(simConfig.Serialize());
        application = SimulationStarter.BuildApplication(description, simConfig);
    }
    else
    {
        Console.WriteLine(&quot;Use default simulation config:&quot;);
        Console.WriteLine(config.Serialize());
        application = SimulationStarter.BuildApplication(description, config);
    }

    var simulation = application.Resolve&lt;ISimulation&gt;();

    var watch = Stopwatch.StartNew();
    var state = simulation.StartSimulation();

    // optional: store agent trips in external GEOJSON file (see Part 4 below)

    watch.Stop();            
    Console.WriteLine($&quot;Executed iterations {state.Iterations} lasted {watch.Elapsed}&quot;);
    application.Dispose();
}
</code></pre><hr>
<h2 id="store-agent-trips-in-geojson-file">Store agent trips in GEOJSON file</h2>
<p>In order to store agent trips (for later analysis and visualization), the following code can be added to the example in Part 3.</p>
<pre><code class="lang-c#">    var layers = state.Model.AllActiveLayers;
    foreach (var layer in layers)
    {
        if (layer is CitizenLayer citizenLayer)
        {
        var citizens = citizenLayer.PedestrianMap.Values;
        TripsOutputAdapter.PrintTripResult(citizens);
        }
    }
</code></pre><p>For more information on agent trips and visualization of agent movement, please click <a href="../analysis-and-visualization/visualizing_agent_trips_kepler.html">here</a>.</p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/MARS-Group-HAW/life/blob/main/Documentation/articles/core/tutorials/main_and_configs.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Copyright &copy MARS GROUP.<br><strong>HAW Hamburg</strong></span>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
